<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>I'd like to think security as a thing that at first refuses everything, and after that permits something specific. Your code does the opposite at the moment. It checks that if the user is NOT logged in, and if the condition does not pass, the user is permitted to view the page.</p>

<p>I'd do the opposite. I would first check that if the user IS logged in, and only after that permit the user to view the page if the condition pass. It is more strict when it comes to potential bugs, which means that if something goes wrong, the user will not be permitted anyhow.</p>

<p>Second thing, you really do not want to tell the browser the user name in the cookie you set. Instead you should hash it with some <a href="http://en.wikipedia.org/wiki/Salt_%28cryptography%29" rel="nofollow">secret salt</a> if it really is necessary to send it to the browser. Remember, every detail you send to the browser is a potential security risk that someone (<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack" rel="nofollow">man-in-the-middle attack</a>, viruses, other malware) might abuse.</p>

<p>And then, if that is a php script you include at the top of every page, why do you include the login form there? It seems to me that you only display it when you are on index.php. It is not needed elsewhere. Of course this is not a big issue, but it's the tiny little seed of bloated software that will grow in time if not treated carefully. And by this I mean that if you begin to add lots and lots of thing that is being used in only one place, it will make the script run so much slower.</p>

<p>Also, I see a potential bug there. If you ever wanted to add a POST form (say, a guestbook or chat or shoutbox or your own forum) on your website, you will trigger the login() function every time when ANY of those POST forms get submitted. The login() function will not then find the correct data in the POST variable, and will refuse to display the page.</p>
    </div>