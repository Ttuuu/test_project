<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p><code>IO.File.ReadAllBytes(file)</code> seems like overkill.  Most file formats have signatures that appear within the first few kilobytes.  There are, however, <a href="https://en.wikipedia.org/wiki/List_of_file_signatures" rel="nofollow noreferrer">signatures</a> where the signature does not appear at the start of the file (e.g. TAR archives), as well as signatures with subtype information at discontinuous locations (e.g. <a href="https://www.freebsd.org/cgi/man.cgi?query=magic&amp;sektion=5" rel="nofollow noreferrer">DOS / Windows executables</a>).  Depending on how ambitious you want to be, you may need to generalize how the signatures are specified.</p>
    </div>