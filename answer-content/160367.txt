<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>You should probably reduce the number of database queries, first you repeat the SiteEmployee search 3 times. Do it once and store it in a a variable. I would also query the database once with an <code>order</code> clause together with the <code>Enumerable</code> <code>group_by</code> method to get all of the results in one go.</p>
    </div>