<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>It might lead to a ton of refactoring, but have you considered breaking up your code field into multiple columns, and simply ordering by them all?</p>

<p>Beyond that, magic in callbacks is always risky as you've pointed out. But with such a complex requirement for ordering, doing it manually each time doesn't make a lot of sense either.</p>
    </div>