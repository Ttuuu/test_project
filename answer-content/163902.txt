<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>You can try to use <a href="https://github.com/doctrine/doctrine2/blob/master/lib/Doctrine/ORM/Query/Filter/SQLFilter.php" rel="nofollow noreferrer">SQLFilter</a> for this purpose. It allows you to tune SQL query based on some logic. You can pass information about your user's state into filter through DI container and use this information to tune your SQL query. Please note that unlike repositories - SQLFilter works on SQL level, not on DQL. More information can be found into Doctrine's <a href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/filters.html" rel="nofollow noreferrer">documentation</a>.</p>
    </div>