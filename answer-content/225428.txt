<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>I'll flag another issue that wasn't pointed out: it seems that the output array of segs (maybe rename it to segments?) is assumed to be allocated by the caller. Since there is no comment that describes that it needs to be of size 4, then the caller might send a smaller array and then the segs[dots] access would seg fault in the best case and overwrite memory silently in the worst case.
I would either document that requirement or allocate the memory internally and ask the caller to delete[] it.</p>
    </div>