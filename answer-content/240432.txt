<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>There's no way to notify locked consumers of the write end. You might want to modify <code>PopFront</code> and <code>NotifyWriteEnd</code> to return a special null value to every awaiting consumer (or otherwise wake up all the awaiting consumers and notify them the queue is exhausted) when <code>NotifyWriteEnd()</code> is called. Otherwise you'll need a rather serious contract inherent in your application design, that every consumer should know <em>in advance</em> that it <em>would be able</em> to get a matching producer before starting awaiting on the queue.</p>
    </div>