<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>I think the trick here is to move the logic in to SQL, and build it out as a SQL function then call the SQL function from your LINQ query.</p>

<p>Something like this perhaps ...</p>

<p><a href="https://stackoverflow.com/questions/20131632/calling-a-sql-user-defined-function-in-a-linq-query">https://stackoverflow.com/questions/20131632/calling-a-sql-user-defined-function-in-a-linq-query</a></p>
    </div>