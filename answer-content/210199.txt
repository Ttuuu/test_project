<div class="s-prose s-prose__disable-spoiler-hover js-post-body" itemprop="text">
<p>@CrisLuengo's advice is valid. Past that, even if you were to keep your usage of <code>new</code>, there's a very important rule to follow: never mix C and C++ dynamic memory allocation. You've used <code>new</code> and then <code>free</code>, when you should be using <code>new</code> and then <code>delete</code>. Depending on your C libraries, compiler and system, this kind of mixing can do very bad things, potentially stack smashing, etc.</p>
    </div>